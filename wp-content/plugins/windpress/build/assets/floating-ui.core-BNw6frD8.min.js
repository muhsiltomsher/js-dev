const X=["top","right","bottom","left"],Y=["start","end"],Z=X.reduce((t,e)=>t.concat(e,e+"-"+Y[0],e+"-"+Y[1]),[]),$=Math.min,W=Math.max,at=Math.round,rt=Math.floor,lt=t=>({x:t,y:t}),st={left:"right",right:"left",bottom:"top",top:"bottom"},ct={start:"end",end:"start"};function J(t,e,a){return W(t,$(e,a))}function B(t,e){return typeof t=="function"?t(e):t}function k(t){return t.split("-")[0]}function S(t){return t.split("-")[1]}function K(t){return t==="x"?"y":"x"}function N(t){return t==="y"?"height":"width"}function M(t){return["top","bottom"].includes(k(t))?"y":"x"}function Q(t){return K(M(t))}function _(t,e,a){a===void 0&&(a=!1);const n=S(t),r=Q(t),i=N(r);let o=r==="x"?n===(a?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=I(o)),[o,I(o)]}function ft(t){const e=I(t);return[G(t),e,G(e)]}function G(t){return t.replace(/start|end/g,e=>ct[e])}function mt(t,e,a){const n=["left","right"],r=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return a?e?r:n:e?n:r;case"left":case"right":return e?i:o;default:return[]}}function ut(t,e,a,n){const r=S(t);let i=mt(k(t),a==="start",n);return r&&(i=i.map(o=>o+"-"+r),e&&(i=i.concat(i.map(G)))),i}function I(t){return t.replace(/left|right|bottom|top/g,e=>st[e])}function dt(t){return{top:0,right:0,bottom:0,left:0,...t}}function tt(t){return typeof t!="number"?dt(t):{top:t,right:t,bottom:t,left:t}}function U(t){const{x:e,y:a,width:n,height:r}=t;return{width:n,height:r,top:a,left:e,right:e+n,bottom:a+r,x:e,y:a}}function et(t,e,a){let{reference:n,floating:r}=t;const i=M(e),o=Q(e),u=N(o),h=k(e),y=i==="y",c=n.x+n.width/2-r.width/2,s=n.y+n.height/2-r.height/2,m=n[u]/2-r[u]/2;let l;switch(h){case"top":l={x:c,y:n.y-r.height};break;case"bottom":l={x:c,y:n.y+n.height};break;case"right":l={x:n.x+n.width,y:s};break;case"left":l={x:n.x-r.width,y:s};break;default:l={x:n.x,y:n.y}}switch(S(e)){case"start":l[o]-=m*(a&&y?-1:1);break;case"end":l[o]+=m*(a&&y?-1:1);break}return l}const pt=async(t,e,a)=>{const{placement:n="bottom",strategy:r="absolute",middleware:i=[],platform:o}=a,u=i.filter(Boolean),h=await(o.isRTL==null?void 0:o.isRTL(e));let y=await o.getElementRects({reference:t,floating:e,strategy:r}),{x:c,y:s}=et(y,n,h),m=n,l={},f=0;for(let d=0;d<u.length;d++){const{name:p,fn:x}=u[d],{x:g,y:w,data:b,reset:v}=await x({x:c,y:s,initialPlacement:n,placement:m,strategy:r,middlewareData:l,rects:y,platform:o,elements:{reference:t,floating:e}});c=g??c,s=w??s,l={...l,[p]:{...l[p],...b}},v&&f<=50&&(f++,typeof v=="object"&&(v.placement&&(m=v.placement),v.rects&&(y=v.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:r}):v.rects),{x:c,y:s}=et(y,m,h)),d=-1)}return{x:c,y:s,placement:m,strategy:r,middlewareData:l}};async function q(t,e){var a;e===void 0&&(e={});const{x:n,y:r,platform:i,rects:o,elements:u,strategy:h}=t,{boundary:y="clippingAncestors",rootBoundary:c="viewport",elementContext:s="floating",altBoundary:m=!1,padding:l=0}=B(e,t),f=tt(l),d=u[m?s==="floating"?"reference":"floating":s],p=U(await i.getClippingRect({element:(a=await(i.isElement==null?void 0:i.isElement(d)))==null||a?d:d.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(u.floating)),boundary:y,rootBoundary:c,strategy:h})),x=s==="floating"?{x:n,y:r,width:o.floating.width,height:o.floating.height}:o.reference,g=await(i.getOffsetParent==null?void 0:i.getOffsetParent(u.floating)),w=await(i.isElement==null?void 0:i.isElement(g))?await(i.getScale==null?void 0:i.getScale(g))||{x:1,y:1}:{x:1,y:1},b=U(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:x,offsetParent:g,strategy:h}):x);return{top:(p.top-b.top+f.top)/w.y,bottom:(b.bottom-p.bottom+f.bottom)/w.y,left:(p.left-b.left+f.left)/w.x,right:(b.right-p.right+f.right)/w.x}}const gt=t=>({name:"arrow",options:t,async fn(e){const{x:a,y:n,placement:r,rects:i,platform:o,elements:u,middlewareData:h}=e,{element:y,padding:c=0}=B(t,e)||{};if(y==null)return{};const s=tt(c),m={x:a,y:n},l=Q(r),f=N(l),d=await o.getDimensions(y),p=l==="y",x=p?"top":"left",g=p?"bottom":"right",w=p?"clientHeight":"clientWidth",b=i.reference[f]+i.reference[l]-m[l]-i.floating[f],v=m[l]-i.reference[l],O=await(o.getOffsetParent==null?void 0:o.getOffsetParent(y));let D=O?O[w]:0;(!D||!await(o.isElement==null?void 0:o.isElement(O)))&&(D=u.floating[w]||i.floating[f]);const T=b/2-v/2,A=D/2-d[f]/2-1,R=$(s[x],A),H=$(s[g],A),E=R,V=D-d[f]-H,P=D/2-d[f]/2+T,z=J(E,P,V),C=!h.arrow&&S(r)!=null&&P!==z&&i.reference[f]/2-(P<E?R:H)-d[f]/2<0,L=C?P<E?P-E:P-V:0;return{[l]:m[l]+L,data:{[l]:z,centerOffset:P-z-L,...C&&{alignmentOffset:L}},reset:C}}});function ht(t,e,a){return(t?[...a.filter(n=>S(n)===t),...a.filter(n=>S(n)!==t)]:a.filter(n=>k(n)===n)).filter(n=>t?S(n)===t||(e?G(n)!==n:!1):!0)}const yt=function(t){return t===void 0&&(t={}),{name:"autoPlacement",options:t,async fn(e){var a,n,r;const{rects:i,middlewareData:o,placement:u,platform:h,elements:y}=e,{crossAxis:c=!1,alignment:s,allowedPlacements:m=Z,autoAlignment:l=!0,...f}=B(t,e),d=s!==void 0||m===Z?ht(s||null,l,m):m,p=await q(e,f),x=((a=o.autoPlacement)==null?void 0:a.index)||0,g=d[x];if(g==null)return{};const w=_(g,i,await(h.isRTL==null?void 0:h.isRTL(y.floating)));if(u!==g)return{reset:{placement:d[0]}};const b=[p[k(g)],p[w[0]],p[w[1]]],v=[...((n=o.autoPlacement)==null?void 0:n.overflows)||[],{placement:g,overflows:b}],O=d[x+1];if(O)return{data:{index:x+1,overflows:v},reset:{placement:O}};const D=v.map(A=>{const R=S(A.placement);return[A.placement,R&&c?A.overflows.slice(0,2).reduce((H,E)=>H+E,0):A.overflows[0],A.overflows]}).sort((A,R)=>A[1]-R[1]),T=((r=D.filter(A=>A[2].slice(0,S(A[0])?2:3).every(R=>R<=0))[0])==null?void 0:r[0])||D[0][0];return T!==u?{data:{index:x+1,overflows:v},reset:{placement:T}}:{}}}},wt=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var a,n;const{placement:r,middlewareData:i,rects:o,initialPlacement:u,platform:h,elements:y}=e,{mainAxis:c=!0,crossAxis:s=!0,fallbackPlacements:m,fallbackStrategy:l="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:d=!0,...p}=B(t,e);if((a=i.arrow)!=null&&a.alignmentOffset)return{};const x=k(r),g=M(u),w=k(u)===u,b=await(h.isRTL==null?void 0:h.isRTL(y.floating)),v=m||(w||!d?[I(u)]:ft(u)),O=f!=="none";!m&&O&&v.push(...ut(u,d,f,b));const D=[u,...v],T=await q(e,p),A=[];let R=((n=i.flip)==null?void 0:n.overflows)||[];if(c&&A.push(T[x]),s){const P=_(r,o,b);A.push(T[P[0]],T[P[1]])}if(R=[...R,{placement:r,overflows:A}],!A.every(P=>P<=0)){var H,E;const P=(((H=i.flip)==null?void 0:H.index)||0)+1,z=D[P];if(z&&(!(s==="alignment"&&g!==M(z))||R.every(L=>L.overflows[0]>0&&M(L.placement)===g)))return{data:{index:P,overflows:R},reset:{placement:z}};let C=(E=R.filter(L=>L.overflows[0]<=0).sort((L,j)=>L.overflows[1]-j.overflows[1])[0])==null?void 0:E.placement;if(!C)switch(l){case"bestFit":{var V;const L=(V=R.filter(j=>{if(O){const F=M(j.placement);return F===g||F==="y"}return!0}).map(j=>[j.placement,j.overflows.filter(F=>F>0).reduce((F,ot)=>F+ot,0)]).sort((j,F)=>j[1]-F[1])[0])==null?void 0:V[0];L&&(C=L);break}case"initialPlacement":C=u;break}if(r!==C)return{reset:{placement:C}}}return{}}}};function nt(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function it(t){return X.some(e=>t[e]>=0)}const xt=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:a}=e,{strategy:n="referenceHidden",...r}=B(t,e);switch(n){case"referenceHidden":{const i=await q(e,{...r,elementContext:"reference"}),o=nt(i,a.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:it(o)}}}case"escaped":{const i=await q(e,{...r,altBoundary:!0}),o=nt(i,a.floating);return{data:{escapedOffsets:o,escaped:it(o)}}}default:return{}}}}};async function vt(t,e){const{placement:a,platform:n,elements:r}=t,i=await(n.isRTL==null?void 0:n.isRTL(r.floating)),o=k(a),u=S(a),h=M(a)==="y",y=["left","top"].includes(o)?-1:1,c=i&&h?-1:1,s=B(e,t);let{mainAxis:m,crossAxis:l,alignmentAxis:f}=typeof s=="number"?{mainAxis:s,crossAxis:0,alignmentAxis:null}:{mainAxis:s.mainAxis||0,crossAxis:s.crossAxis||0,alignmentAxis:s.alignmentAxis};return u&&typeof f=="number"&&(l=u==="end"?f*-1:f),h?{x:l*c,y:m*y}:{x:m*y,y:l*c}}const bt=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var a,n;const{x:r,y:i,placement:o,middlewareData:u}=e,h=await vt(e,t);return o===((a=u.offset)==null?void 0:a.placement)&&(n=u.arrow)!=null&&n.alignmentOffset?{}:{x:r+h.x,y:i+h.y,data:{...h,placement:o}}}}},At=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:a,y:n,placement:r}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:u={fn:p=>{let{x,y:g}=p;return{x,y:g}}},...h}=B(t,e),y={x:a,y:n},c=await q(e,h),s=M(k(r)),m=K(s);let l=y[m],f=y[s];if(i){const p=m==="y"?"top":"left",x=m==="y"?"bottom":"right",g=l+c[p],w=l-c[x];l=J(g,l,w)}if(o){const p=s==="y"?"top":"left",x=s==="y"?"bottom":"right",g=f+c[p],w=f-c[x];f=J(g,f,w)}const d=u.fn({...e,[m]:l,[s]:f});return{...d,data:{x:d.x-a,y:d.y-n,enabled:{[m]:i,[s]:o}}}}}},Rt=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:a,y:n,placement:r,rects:i,middlewareData:o}=e,{offset:u=0,mainAxis:h=!0,crossAxis:y=!0}=B(t,e),c={x:a,y:n},s=M(r),m=K(s);let l=c[m],f=c[s];const d=B(u,e),p=typeof d=="number"?{mainAxis:d,crossAxis:0}:{mainAxis:0,crossAxis:0,...d};if(h){const w=m==="y"?"height":"width",b=i.reference[m]-i.floating[w]+p.mainAxis,v=i.reference[m]+i.reference[w]-p.mainAxis;l<b?l=b:l>v&&(l=v)}if(y){var x,g;const w=m==="y"?"width":"height",b=["top","left"].includes(k(r)),v=i.reference[s]-i.floating[w]+(b&&((x=o.offset)==null?void 0:x[s])||0)+(b?0:p.crossAxis),O=i.reference[s]+i.reference[w]+(b?0:((g=o.offset)==null?void 0:g[s])||0)-(b?p.crossAxis:0);f<v?f=v:f>O&&(f=O)}return{[m]:l,[s]:f}}}},Pt=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var a,n;const{placement:r,rects:i,platform:o,elements:u}=e,{apply:h=()=>{},...y}=B(t,e),c=await q(e,y),s=k(r),m=S(r),l=M(r)==="y",{width:f,height:d}=i.floating;let p,x;s==="top"||s==="bottom"?(p=s,x=m===(await(o.isRTL==null?void 0:o.isRTL(u.floating))?"start":"end")?"left":"right"):(x=s,p=m==="end"?"top":"bottom");const g=d-c.top-c.bottom,w=f-c.left-c.right,b=$(d-c[p],g),v=$(f-c[x],w),O=!e.middlewareData.shift;let D=b,T=v;if((a=e.middlewareData.shift)!=null&&a.enabled.x&&(T=w),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(D=g),O&&!m){const R=W(c.left,0),H=W(c.right,0),E=W(c.top,0),V=W(c.bottom,0);l?T=f-2*(R!==0||H!==0?R+H:W(c.left,c.right)):D=d-2*(E!==0||V!==0?E+V:W(c.top,c.bottom))}await h({...e,availableWidth:T,availableHeight:D});const A=await o.getDimensions(u.floating);return f!==A.width||d!==A.height?{reset:{rects:!0}}:{}}}};export{yt as a,gt as b,pt as c,Pt as d,lt as e,wt as f,at as g,xt as h,$ as i,rt as j,Rt as l,W as m,bt as o,U as r,At as s};
